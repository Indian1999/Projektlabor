{% extends "base.html" %}

{% block title %}Új folyamat - Cube Solver{% endblock %}

{% block content %}
<div class="card shadow-sm mb-4">
    <div class="card-body">
        <h1 class="mb-2">Új folyamat indítása</h1>
        <p class="text-muted mb-0">Válaszd ki az algoritmust és állítsd be a paramétereket</p>
    </div>
</div>

<div class="row justify-content-center">
    <div class="col-lg-10">
        <div class="card shadow-sm">
            <div class="card-body p-4">
                <form id="newProcessForm">
                    <div class="mb-4">
                        <label class="form-label fw-bold">Algoritmus típusa</label>
                        <div class="btn-group w-100" role="group">
                            <input type="radio" class="btn-check" name="type" id="typeGenetic" value="genetic" checked onchange="updateFormFields()">
                            <label class="btn btn-outline-primary" for="typeGenetic">Genetikus algoritmus</label>
                            
                            <input type="radio" class="btn-check" name="type" id="typeConstructive" value="constructive" onchange="updateFormFields()">
                            <label class="btn btn-outline-primary" for="typeConstructive">Constructive Heuristic</label>
                        </div>
                    </div>

                    <h5 class="border-bottom pb-2 mb-3">Általános paraméterek</h5>
                    <div class="row g-3 mb-4">
                        <div class="col-md-4">
                            <label for="n" class="form-label">N (kockák száma)</label>
                            <input type="number" class="form-control" id="n" name="n" value="12" min="8" max="200" required>
                            <div class="form-text">Min: 8, Max: 200</div>
                        </div>
                        <div class="col-md-4">
                            <label for="accuracy" class="form-label">Pontosság (tizedesjegyek)</label>
                            <input type="number" class="form-control" id="accuracy" name="accuracy" value="0" min="0" max="2">
                            <div class="form-text">0 = egész számok, 1-2 = finomabb (kísérleti)</div>
                        </div>
                        <div class="col-md-4">
                            <label for="priority" class="form-label">Prioritás</label>
                            <input type="number" class="form-control" id="priority" name="priority" value="0">
                            <div class="form-text">Magasabb = fontosabb</div>
                        </div>
                    </div>
                    <!-- Genetic-->
                    <div id="geneticParams" class="border rounded p-3 mb-4 bg-light">
                        <h5 class="mb-3">Genetikus algoritmus paraméterei</h5>
                        <div class="row g-3">
                            <div class="col-md-6">
                                <label for="population_size" class="form-label">Populáció méret</label>
                                <input type="number" class="form-control" id="population_size" name="population_size" value="50" min="1">
                                <div class="form-text">Ajánlott: 30-100</div>
                            </div>
                            <div class="col-md-6">
                                <label for="generations" class="form-label">Generációk száma</label>
                                <input type="number" class="form-control" id="generations" name="generations" value="100" min="0">
                                <div class="form-text">0 = végtelen</div>
                            </div>
                            <div class="col-md-6">
                                <label for="mutation_rate" class="form-label">Mutációs ráta</label>
                                <input type="number" class="form-control" id="mutation_rate" name="mutation_rate" value="0.1" min="0" max="1" step="0.01">
                            </div>
                            <div class="col-md-6">
                                <label for="fitness_mode" class="form-label">Fitness mód</label>
                                <select class="form-select" id="fitness_mode" name="fitness_mode">
                                    <option value="1">1 - Monte Carlo (gyors)</option>
                                    <option value="2" selected>2 - Grid coverage (pontos)</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <!-- Constructive-->
                    <div id="constructiveParams" class="border rounded p-3 mb-4 bg-light" style="display: none;">
                        <h5 class="mb-3">Constructive Heuristic paraméterei</h5>
                        <div class="row g-3">
                            <div class="col-md-6">
                                <label for="strategy" class="form-label">Stratégia</label>
                                <select class="form-select" id="strategy" name="strategy">
                                    <!--<option value="hybrid" selected>Hybrid</option>-->
                                    <option value="corner_first">Corner First</option>
                                    <!--<option value="gap_filling">Gap Filling</option>-->
                                    <!--<option value="layer_by_layer">Layer by Layer</option>-->
                                </select>
                            </div>
                            <div class="col-md-6">
                                <label for="iterations" class="form-label">Iterációk száma</label>
                                <input type="number" class="form-control" id="iterations" name="iterations" value="1" min="1" max="10">
                                <div class="form-text">Min: 1, Max: 10</div>
                            </div>
                        </div>
                    </div>

                    <div class="mb-4">
                        <div class="form-check">
                            <input class="form-check-input" type="checkbox" id="start_immediately" name="start_immediately" checked>
                            <label class="form-check-label" for="start_immediately">
                                Azonnali indítás (megállítja az aktív folyamatot)
                            </label>
                        </div>
                    </div>

                    <div class="d-flex gap-2">
                        <button type="submit" class="btn btn-success btn-lg">Folyamat indítása</button>
                        <a href="/processes" class="btn btn-secondary btn-lg">Mégse</a>
                    </div>
                </form>

                <div id="formStatus" class="mt-3" style="display: none;"></div>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script src="{{ url_for('static', filename='js/new_process.js') }}"></script>
{% endblock %}